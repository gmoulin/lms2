<script type="text/html" id="list_book_tmpl">
<%
	var item, i, j, url, id, author;
	for( i = 0; i < list.length; i += 1 ){
		item = list[i];
		url = getFullUrl('image.php?cover=book&id=', item.bookID);
	%>
		<article class="item" style="background-image: url(<%=url%>);">
			<img src="<%=url%>" class="list-hide">
			<dl>
				<dt>Title</dt>
				<dd><%=item.bookTitle%></dd>

				<dt>Author<% if( item.authors.length > 1 ){ %>s<% } %></dt>
				<%  j = 0;
					for( id in item.authors ){
						if( item.authors.hasOwnProperty(id) ){
							author = item.authors[ id ];
				%>
					<dd class="<% if( j > 3 ){ %>list-hide<% } %>">
						<%=author.authorFirstName%> <%=author.authorLastName%>
						<button class="btn btn-small btn-info filter"
							data-filter="author" data-value="<%=author.authorFirstName%> <%=author.authorLastName%>"
						><i class="icon-search"></i></button>

					</dd>
					<%  }
						j++;
					} %>

				<% if( item.sagaTitle !== null ){ %>
					<dt>Saga</dt>
					<dd>
						<%=item.sagaTitle%> - <%=item.bookSagaPosition%> / <%=item.bookSagaSize%>
						<button class="btn btn-small btn-info filter"
							data-filter="saga" data-value="<%=item.sagaTitle%>"
						><i class="icon-search"></i></button>
					</dd>
				<% } %>

				<dt>Format</dt>
				<dd><%=item.bookSize%></dd>

				<dt>Storage</dt>
				<dd>
					<%=item.storageRoom%> - <%=item.storageType%>
					<% if( item.storageColumn !== null || item.storageLine !== null ){ %>
						- <%=item.storageColumn%><%=item.storageLine%>
					<% } %>
					<div class="btn-group list-hide">
						<% if( item.storageColumn !== null || item.storageLine !== null ){ %>
							<button class="btn storage-picture btn-info btn-small"
								data-toggle="modal" data-target="#storage_picture" data-manage="book"
								data-storageID="<%=item.storageID%>"
								title="View storage picture"
							><i class="icon-map-marker"></i></button>
						<% } %>
						<% if( item.sagaTitle !== null && item.storageRoom == 'aucun' ){ %>
							<button class="btn store btn-warning btn-small"
								data-toggle="modal" data-target="#store_with_saga" data-manage="book"
								data-itemId="<%=item.bookID%>" data-sagaID="<%=item.sagaID%>"
								title="Store with saga"
							><i class="icon-inbox"></i></button>
						<% } %>
					</div>
					<button class="btn btn-small btn-info filter"
						data-filter="storage" data-value="<%=item.storageID%>"
					><i class="icon-search"></i></button>
				</dd>

				<% if( item.loanHolder !== null ){ %>
					<dt>Loan</dt>
					<dd>
						<%=item.loanHolder%> - <%=item.loanDate%>
						<button class="btn delete btn-danger dtn-small list-hide"
							data-toggle="modal" data-target="#delete_loan" data-manage="loan"
							data-itemId="<%=item.bookID%>"
							title="Delete loan"
						><i class="icon-trash"></i></button>
						<button class="btn btn-small btn-info filter"
							data-filter="loan" data-value="<%=item.loanHolder%>"
						><i class="icon-search"></i></button>
					</dd>
				<% } %>

				<dt>Actions</dt>
				<dd>
					<div class="btn-group">
						<button class="btn detail btn-info btn-small" data-toggle="modal" data-target="#detail_book" data-manage="book">
							<i class="icon-eye-open"></i> Detail
						</button>

						<button class="btn edit btn-warning btn-small"
							data-toggle="modal" data-target="#edit_book" data-manage="book"
							data-itemId="<%=item.bookID%>"
						><i class="icon-edit"></i> Edit</button>

						<button class="btn delete btn-danger btn-small"
							data-toggle="modal" data-target="#delete_book" data-manage="book"
							data-itemId="<%=item.bookID%>"
						><i class="icon-trash"></i> Delete</button>

						<button class="btn add btn-info btn-small"
							data-toggle="modal" data-target="#edit_loan" data-manage="loan"
							data-itemId="<%=item.bookID%>" data-relation="book"
						><i class="icon-user"></i> Loan</button>
					</div>
				</dd>
			</dl>
		</article>
	<% } %>
</script>

